<!DOCTYPE html>
<html lang="ar">

<head>
  <meta charset="UTF-8">
  <title>Valentine ‚ù§Ô∏è Mariam</title>

  <style>
    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      font-family: 'Segoe UI', sans-serif;
      transition: .6s;
      overflow-y: auto;
    }

    body.pink {
      background: linear-gradient(135deg, #ff758c, #ff7eb3, #ff758c);
      background-size: 200% 200%;
      animation: gradientBG 15s ease infinite;
    }

    body.dark {
      background: linear-gradient(135deg, #1f1f1f, #3a3a3a, #1f1f1f);
      background-size: 200% 200%;
      animation: gradientBG 15s ease infinite;
    }

    body.gold {
      background: linear-gradient(135deg, #cfa349, #f7e27c, #cfa349);
      background-size: 200% 200%;
      animation: gradientBG 15s ease infinite;
    }

    @keyframes gradientBG {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    .card {
      background: rgba(255, 255, 255, .95);
      padding: 40px;
      border-radius: 25px;
      text-align: center;
      box-shadow: 0 25px 50px rgba(0, 0, 0, .25);
      max-width: 370px;
      margin: 40px 0;
      animation: pop 1s;
    }

    body.dark .card {
      background: rgba(20, 20, 20, .95);
      color: white
    }

    h1 {
      color: #ff4d6d;
      margin-bottom: 10px
    }

    p {
      font-size: 17px;
      line-height: 1.9;
      margin: 10px 0
    }

    #date {
      font-size: 13px;
      opacity: .7;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .signature {
      margin-top: 12px;
      font-size: 14px;
      opacity: .8
    }

    button {
      margin-top: 15px;
      padding: 12px 25px;
      border: none;
      border-radius: 30px;
      background: #ff4d6d;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: .3s
    }

    button:hover {
      transform: scale(1.08)
    }

    .themes button {
      background: #ddd;
      color: #333;
      font-size: 14px;
      padding: 6px 14px;
      margin: 5px
    }

    .heart {
      position: absolute;
      opacity: .85;
      animation: float 5s linear infinite;
      pointer-events: none;
    }

    .star {
      animation: float 5s linear infinite, sparkle 1.2s ease-in-out infinite
    }

    #finalHeart {
      font-size: 0;
      opacity: 0;
      transition: 1s;
    }

    @keyframes sparkle {

      0%,
      100% {
        opacity: .5;
        transform: scale(1)
      }

      50% {
        opacity: 1;
        transform: scale(1.4)
      }
    }

    @keyframes float {
      from {
        transform: translateY(100vh)
      }

      to {
        transform: translateY(-10vh)
      }
    }

    @keyframes pop {
      from {
        transform: scale(0)
      }

      to {
        transform: scale(1)
      }
    }

    /* Login Overlay Styles */
    #loginOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.8s ease-out, visibility 0.8s;
    }

    #loginOverlay.hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .login-card {
      background: rgba(255, 255, 255, 0.9);
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      text-align: center;
      max-width: 90%;
      width: 350px;
      animation: pop 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .login-card h2 {
      color: #ff4d6d;
      margin-bottom: 20px;
      font-size: 24px;
    }

    .password-input {
      width: 80%;
      padding: 12px 15px;
      margin: 15px 0;
      border: 2px solid #ffb3c1;
      border-radius: 25px;
      outline: none;
      font-size: 16px;
      text-align: center;
      transition: 0.3s;
      color: #333;
    }

    .password-input:focus {
      border-color: #ff4d6d;
      box-shadow: 0 0 10px rgba(255, 77, 109, 0.3);
    }

    .login-btn {
      background: #ff4d6d;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
      margin-top: 10px;
      box-shadow: 0 4px 15px rgba(255, 77, 109, 0.4);
    }

    .login-btn:hover {
      background: #ff2a55;
      transform: translateY(-2px);
    }

    .error-msg {
      color: #d00000;
      margin-top: 10px;
      font-size: 14px;
      min-height: 20px;
      opacity: 0;
      transition: 0.3s;
    }

    .error-msg.visible {
      opacity: 1;
      animation: shake 0.4s ease-in-out;
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      25% {
        transform: translateX(-5px);
      }

      75% {
        transform: translateX(5px);
      }
    }

    /* Enhanced Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes sway {
      0% {
        transform: translateX(0) rotate(0deg);
      }

      25% {
        transform: translateX(15px) rotate(5deg);
      }

      50% {
        transform: translateX(0) rotate(0deg);
      }

      75% {
        transform: translateX(-15px) rotate(-5deg);
      }

      100% {
        transform: translateX(0) rotate(0deg);
      }
    }

    @keyframes pulse-glow {
      0% {
        box-shadow: 0 0 0 0 rgba(255, 77, 109, 0.4);
      }

      70% {
        box-shadow: 0 0 0 10px rgba(255, 77, 109, 0);
      }

      100% {
        box-shadow: 0 0 0 0 rgba(255, 77, 109, 0);
      }
    }

    .animate-text {
      animation: fadeInUp 0.8s ease-out forwards;
    }

    .card-container {
      perspective: 1000px;
    }

    .card {
      transition: transform 0.1s ease-out;
      transform-style: preserve-3d;
    }

    /* Polished Button */
    button {
      position: relative;
      overflow: hidden;
    }

    button::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%);
      transform-origin: 50% 50%;
    }

    button:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }

    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }

      100% {
        transform: scale(20, 20);
        opacity: 0;
      }
    }

    /* Envelope Styles */
    #envelope-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 500;
      transition: opacity 0.8s ease-out;
      /* Fade out container */
    }

    .envelope {
      position: relative;
      width: 300px;
      height: 200px;
      background: #ff4d6d;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      transform-style: preserve-3d;
    }

    .envelope:hover {
      transform: scale(1.05);
      transition: transform 0.3s;
    }

    .envelope::before {
      /* Flap */
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 0;
      border-left: 150px solid transparent;
      border-right: 150px solid transparent;
      border-top: 100px solid #ff758c;
      transform-origin: top;
      transition: transform 0.8s ease-in-out, z-index 0.8s;
      /* Smooth open */
      z-index: 3;
    }

    .envelope::after {
      /* Pocket body */
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 0;
      border-left: 150px solid #ff4d6d;
      border-right: 150px solid #ff4d6d;
      border-bottom: 100px solid #ff2a55;
      border-top: 100px solid transparent;
      z-index: 2;
      border-radius: 0 0 10px 10px;
      pointer-events: none;
      /* Let clicks pass to card if needed */
    }

    .card-preview {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 90%;
      background: white;
      z-index: 1;
      transition: transform 1s ease-in-out 0.4s;
      /* Delay slide until flap opens */
    }

    /* Envelope Open State */
    .envelope.open::before {
      transform: rotateX(180deg);
      z-index: 0;
    }

    .envelope.open .card-preview {
      transform: translateX(-50%) translateY(-120px);
      z-index: 4;
    }

    .corazon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 40px;
      z-index: 4;
      transition: opacity 0.5s;
      pointer-events: none;
    }

    .instruction {
      margin-top: 40px;
      color: white;
      font-size: 1.2rem;
      animation: pulse-glow 2s infinite;
      pointer-events: none;
    }

    /* Typewriter Cursor */
    .typewriter-cursor {
      display: inline-block;
      width: 2px;
      height: 1.2em;
      background-color: #ff4d6d;
      margin-left: 2px;
      animation: blink 1s steps(2, start) infinite;
      vertical-align: text-bottom;
    }

    @keyframes blink {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0;
      }
    }

    /* Burst Particles */
    .burst-particle {
      position: absolute;
      pointer-events: none;
      width: 8px;
      height: 8px;
      background: #ff4d6d;
      border-radius: 50%;
      animation: fadeTranslate 1s forwards cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    @keyframes fadeTranslate {
      to {
        transform: translate(var(--tx), var(--ty));
        opacity: 0;
      }
    }

    /* Photo Reveal */
    .hidden-photo {
      opacity: 0;
      transform: scale(0.95);
      filter: blur(10px);
      transition: opacity 1.5s ease, transform 1.5s ease, filter 1.5s ease;
      margin-top: 30px;
      border: 8px solid white;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      transform: rotate(-3deg);
      max-width: 200px;
      margin-left: auto;
      margin-right: auto;
      visibility: hidden;
    }

    .hidden-photo.visible {
      opacity: 1;
      visibility: visible;
      transform: scale(1) rotate(-3deg);
      filter: blur(0);
    }

    .hidden-photo img {
      width: 100%;
      display: block;
    }

    .hidden-photo .caption {
      background: white;
      color: #555;
      font-family: 'Courier New', monospace;
      padding: 10px;
      font-size: 13px;
      font-weight: bold;
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce) {

      *,
      ::before,
      ::after {
        animation-duration: 0.01s !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01s !important;
        scroll-behavior: auto !important;
      }

      .typewriter-cursor {
        display: none;
      }
    }
  </style>
</head>

<body class="pink">
  <!-- Login Overlay -->
  <div id="loginOverlay">
    <div class="login-card">
      <h2>üîí Enter Password</h2>
      <p style="font-size: 14px; color: #666; margin-bottom: 15px;">To see my heart, type the magic word...</p>
      <input type="password" id="passwordInput" class="password-input" placeholder="Password here..."
        onkeypress="checkEnter(event)">
      <br>
      <button class="login-btn" onclick="checkPassword()">Unlock ‚ù§Ô∏è</button>
      <div id="errorMsg" class="error-msg">Incorrect password üíî</div>
    </div>
  </div>

  <!-- Envelope Intro -->
  <div id="envelope-container">
    <div class="envelope" onclick="openEnvelope()">
      <div class="front"></div>
      <div class="card-preview"></div>
      <div class="corazon">‚ù§Ô∏è</div>
    </div>
    <div class="instruction">Click to Open üíå</div>
  </div>

  <div class="card" id="mainCard" style="display: none; opacity: 0;">
    <h1>‚ù§Ô∏è ŸÖÿ±ŸäŸÖ ‚ù§Ô∏è</h1>

    <div id="date">July 2025</div>

    <div id="lines"></div>

    <!-- Hidden Photo Reveal -->
    <div id="photo-container" class="hidden-photo">
      <!-- Placeholder image: User needs to update this source -->
      <img src="image/us.jpeg" alt="Us" id="secretPhoto">
      <div class="caption">Forever & Always ‚ôæÔ∏è</div>
    </div>

    <p id="finalHeart">‚ù§Ô∏è</p>

    <div class="signature">‚Äî ŸÉŸäÿ±ŸÑÿ≥</div>

    <!-- Removed "Start" button as opening the envelope starts it -->

    <div class="themes">
      <button onclick="setTheme('pink')">Pink üíó</button>
      <button onclick="setTheme('dark')">Dark üåô</button>
      <button onclick="setTheme('gold')">Gold ‚ú®</button>
    </div>
  </div>

  <!-- MUSIC -->
  <audio id="bgMusic" loop
    src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/ccCommunity/Kevin_MacLeod/Classical_Sampler/Kevin_MacLeod_-_Gymnopedie_No_1.mp3"></audio>

  <script>
    let theme = "pink";
    let started = false;
    let isOpening = false; // Interaction lock
    const audio = document.getElementById("bgMusic");

    // Text Content
    const textLines = [
      "ŸÖÿ±ŸäŸÖ ‚ù§Ô∏è",
      "ŸäŸÖŸÉŸÜ ŸÖÿ¥ ÿ®ÿπÿ±ŸÅ ÿ£ÿπÿ®Ÿëÿ± ŸÉÿ™Ÿäÿ± ÿ®ÿßŸÑŸÉŸÑÿßŸÖÿå",
      "ÿ®ÿ≥ ÿ≠ÿßÿ®ÿ® ÿ£ŸÇŸàŸÑŸÉ ÿ•ŸÜ Ÿàÿ¨ŸàÿØŸÉ ŸÅŸä ÿ≠Ÿäÿßÿ™Ÿä ŸÅÿ±ŸÇ ŸÖÿπÿßŸäÿß ÿ®ÿ¨ÿØ.",
      "ŸÉŸÑ ŸÑÿ≠ÿ∏ÿ© ÿ®ŸäŸÜÿß ŸÅŸäŸáÿß ÿ∂ÿ≠ŸÉÿå",
      "ÿ£Ÿà ÿ≠ÿ™Ÿâ ÿ≤ÿπŸÑ ÿ®ÿ≥Ÿäÿ∑ÿå",
      "ÿ®ÿ™ÿπŸÑŸëŸÖŸÜŸä ŸÇÿØ ÿ•ŸäŸá ÿ•ŸÜÿ™Ÿê ŸÇÿ±Ÿäÿ®ÿ© ŸÖŸÜ ŸÇŸÑÿ®Ÿä.",
      "",
      "ŸÅŸä ÿßŸÑŸÅŸÑÿßŸÜÿ™ŸäŸÜÿå",
      "ŸÖÿ¥ ÿ®ÿ≥ ÿ®ÿ≠ÿ™ŸÅŸÑ ÿ®ŸäŸÉŸä‚Ä¶",
      "ÿ£ŸÜÿß ÿ®ÿ≠ÿ™ŸÅŸÑ ÿ®ÿßŸÑÿ•ÿ≠ÿ≥ÿßÿ≥ ÿßŸÑŸáÿßÿØŸä",
      "ÿßŸÑŸÑŸä ÿ®ŸäŸäÿ¨Ÿä ŸÑŸÖÿß ÿ£ŸÉŸàŸÜ ŸÖÿπÿßŸÉŸä.",
      "",
      "ÿ£ÿ™ŸÖŸÜŸâ ŸÜŸÅÿ∂ŸÑ ÿØÿßŸäŸÖŸãÿß ÿ≥ŸÜÿØ ŸÑÿ®ÿπÿ∂ÿå",
      "ŸàŸÜŸÉŸÖŸÑ ÿßŸÑÿ∑ÿ±ŸäŸÇ Ÿàÿ•ÿ≠ŸÜÿß ÿ£ŸÇŸàŸâ",
      "Ÿàÿ£ÿÆŸÅ ÿπŸÑŸâ ÿ®ÿπÿ∂.",
      "",
      "Happy Valentine‚Äôs Day",
      "Ÿäÿß ÿ£ÿ¨ŸÖŸÑ ÿ≠ÿØ ŸÅŸä ŸäŸàŸÖŸä üåπ"
    ];

    function setTheme(t) {
      theme = t;
      document.body.className = t;
    }

    // --- Interactive Feature 1: Open Envelope ---
    function openEnvelope() {
      if (isOpening) return; // Prevent double clicks
      isOpening = true;
      started = true;

      const envelope = document.querySelector('.envelope');
      const container = document.getElementById('envelope-container');
      const mainCard = document.getElementById('mainCard');
      // Audio element is already defined globally

      // Animate Envelope
      envelope.classList.add('open');
      document.querySelector('.corazon').style.opacity = '0';

      // Start Music
      audio.volume = 0.5;
      audio.play().catch(e => console.log("Click interaction needed for music"));

      // Transition to Card after animation
      // Using timeout to match CSS transition exactly for smoothness
      setTimeout(() => {
        container.style.opacity = '0'; // Fade out container

        // Wait for fade out to finish before switching display
        setTimeout(() => {
          container.style.display = 'none';
          mainCard.style.display = 'block';

          // Trigger reflow/animation
          void mainCard.offsetWidth;
          mainCard.style.opacity = '1';
          mainCard.style.animation = 'pop 1s ease-out';

          // Start Visuals Sequence
          startHearts();
          // Start Typewriter only after card is visible
          typeWriterSequence();
        }, 800);
      }, 1000); // Wait for flap open + slide
    }

    // --- Interactive Feature 2: Async Typewriter Effect ---
    async function typeWriterSequence() {
      const container = document.getElementById("lines");

      // Create permanent cursor
      const cursor = document.createElement('span');
      cursor.className = 'typewriter-cursor';
      container.appendChild(cursor);

      for (let i = 0; i < textLines.length; i++) {
        const line = textLines[i];

        // Handle empty lines (spacers)
        if (line.trim() === "") {
          const br = document.createElement("br");
          container.insertBefore(br, cursor);
          await new Promise(r => setTimeout(r, 400));
          continue;
        }

        // Create paragraph for current line
        const p = document.createElement("p");
        p.setAttribute("data-line", i);
        p.style.minHeight = "24px";
        p.className = "animate-text";
        p.style.display = "block"; // Changed from inline-block to block for proper spacing
        container.insertBefore(p, cursor);

        // Type characters
        for (let char of line) {
          p.textContent += char;
          // Scroll to bottom
          window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

          // Random typing delay
          let delay = Math.random() * 30 + 30; // 30-60ms

          // Longer pause for punctuation
          if ([',', '.', '!', 'ÿü'].includes(char)) delay += 300;

          await new Promise(r => setTimeout(r, delay));
        }

        // Line finished, pause before next
        await new Promise(r => setTimeout(r, 400));
      }

      // Typing Complete - Remove Cursor and Show Final
      cursor.remove();
      showFinalElements();
    }

    function showFinalElements() {
      // Show Final Heart
      const heart = document.getElementById("finalHeart");
      heart.style.fontSize = "50px";
      heart.style.opacity = "1";
      heart.style.animation = "pulse-glow 1.5s infinite";

      // --- Interactive Feature 4: Photo Reveal ---
      const photo = document.getElementById("photo-container");

      // Slight delay for emotional pacing
      setTimeout(() => {
        photo.classList.add('visible');
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
      }, 500);
    }

    // --- Visuals: Hearts ---
    function createHeart() {
      const el = document.createElement("div");
      if (theme === "gold") {
        el.innerHTML = "‚≠ê";
        el.className = "heart star";
        el.style.color = "#fff6c2";
      } else {
        el.innerHTML = "‚ù§Ô∏è";
        el.className = "heart";
        el.style.color = "white";
      }
      el.style.left = Math.random() * 100 + "vw";
      const size = Math.random() * 20 + 10;
      el.style.fontSize = size + "px";
      const duration = Math.random() * 3 + 3;
      el.style.animation = `float ${duration}s linear infinite, sway ${duration * 0.8}s ease-in-out infinite alternate`;
      document.body.appendChild(el);
      setTimeout(() => el.remove(), duration * 1000);
    }

    function startHearts() {
      setInterval(createHeart, 300);
    }

    // --- Interactive Feature 3: Click Bursts (Optimized) ---
    document.addEventListener('click', (e) => {
      // Validation: Don't burst if clicking button or envelope (visual clutter)
      if (e.target.tagName === 'BUTTON' || e.target.closest('.envelope')) return;

      createBurst(e.clientX, e.clientY);
    });

    function createBurst(x, y) {
      const particleCount = 12; // Performance limit
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'burst-particle';

        // Random direction
        const angle = Math.random() * Math.PI * 2;
        const velocity = Math.random() * 80 + 30; // Distance
        const tx = Math.cos(angle) * velocity + 'px';
        const ty = Math.sin(angle) * velocity + 'px';

        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.setProperty('--tx', tx);
        particle.style.setProperty('--ty', ty);

        // Random color
        const colors = ['#ff4d6d', '#ff758c', '#ffffff', '#ffd700'];
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];

        // Auto-cleanup on animation end (Event Driven)
        particle.addEventListener('animationend', () => particle.remove());
        document.body.appendChild(particle);
      }
    }

    setTheme("pink");

    // Login Logic
    function checkPassword() {
      const input = document.getElementById('passwordInput');
      const errorMsg = document.getElementById('errorMsg');
      const overlay = document.getElementById('loginOverlay');

      if (input.value.trim() === "mariam2005") {
        overlay.classList.add('hidden');
        setTimeout(() => {
          overlay.style.display = 'none';
        }, 800);
      } else {
        errorMsg.classList.add('visible');
        input.value = "";
        input.focus();
        setTimeout(() => {
          errorMsg.classList.remove('visible');
        }, 2000);
      }
    }

    function checkEnter(event) {
      if (event.key === "Enter") {
        checkPassword();
      }
    }

    document.addEventListener('mousemove', (e) => {
      const card = document.querySelector('.card');
      if (!card || card.style.display === 'none') return;

      // Reduced Motion Check
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

      const screenX = window.innerWidth / 2;
      const screenY = window.innerHeight / 2;

      const globalRotateX = ((e.clientY - screenY) / screenY) * -3;
      const globalRotateY = ((e.clientX - screenX) / screenX) * 3;

      card.style.transform = `perspective(1000px) rotateX(${globalRotateX}deg) rotateY(${globalRotateY}deg)`;
    });
  </script>
</body>

</html>